<!DOCTYPE html>
<html lang="en">

<head>
    <title>BookInfo</title>
    <!-- Include your CSS and other meta tags here -->
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/static/style.css">
    <link rel="stylesheet" type="text/css" href="/static/header_footer.css">
    <link rel="stylesheet" type="text/css" href="/static/bookstyle.css">
    <!--fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@100;200;300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="../scripts/book_info.js"></script>

</head>

<body>
    <div id="book-info"></div>
    <!--หัวกระดาษ-->
        <div class="header_flexbox_menu">
            <div class="header_menu_item">
                <a class="header_writing_type" href="#">นิยาย</a>
                <a class="header_writing_type" href="#">แฟนฟิค</a>
                <a class="header_writing_type" href="#">การ์ตูน</a>
            </div>
            <div class="header_menu_item">
                <a href="homepage.html"><img src="assets/writearead_img/WriteARead_white.png" class="WriteARead_image"></a>
            </div>
            <div class="header_menu_item">
                <a href="#" onclick="toggle_search()"> <img class="search_icon" src="assets/header_img/search_button_light.png" alt="Original Image"></a>
                <a href="#"> <img class="pen_icon" src="assets/header_img/writing_button_light.png" alt="Original Image"></a>
                <a href="#"> <img class="user_icon" src="assets/header_img/user_button_light.png" alt="Original Image"></a>
            </div>
        </div>

    <!--book info-->
    <div class="book_flexbox">
        <div class="book_item">
            <img class="book_cover" src="assets/covers_img/Shin_chan.png" alt="book_cover" />
        </div>
        <div class="book_info_flexbox">
            <div class="book_info_item">
                <div class="text-0">
                    <a id="genre"></a>
                </div>
            </div>
            <div class="book_info_item">
                <div class="book_title">
                    <a id="bookName"></a>
                </div>
            </div>
            <div class="book_info_item">
                <div class="text-0">
                    <a id="pseudonymInfo"></a>
                </div>
            </div>
            <div class="book_info_item">
                <div class="book_title">
                    <a id="prologueInfo"></a>
                </div>
            </div>
        </div>
    </div>

    <!--prologue-->
    <div class="flexbox-3">
        <div class="item-3">
            <div class="info_title">Prologue</div>
            <a id="prologueDisplay"></a>
        </div>
    </div>
    <div class="flexbox-3">
        <div class="item-3">
            <div class="info_title">Writer information</div>
            <a>Pseudonym : </a>
            <a id="pseudonymDisplay"></a>
            <br>
            <a>Writer : </a>
            <a id="writer_username"></a>
        </div>
    </div>

    <!--lastest edit-->
    <div class="flexbox-3">
        <div class="item-3">
            <div class="info_title">Publish</div>
            <a>Latest Edit : </a>
            <a id="date_time"></a>
        </div>
    </div>

    <!--chapter-->
    <div class="flexbox-3">
        <div class="item-3">
            <a class="info_title">ตอนทั้งหมด</a>
            <div class="chapter_grid">
                <p class="info_text text-3 text-2 chapter_content">บทที่</p>
                <p class="info_text text-3 chapter_content">ชื่อตอน</p>
                <img class="watch_icon chapter_content" src="assets/book_img/eye.png" alt="watched" />
                <p class="info_text text-4 chapter_content">แก้ไข</p>
                <p class="info_text text-3 text-2 chapter_content">#1</p>
                <a href="payment.html" class="text text-3 chapter_content">เมื่อไหร่จะทำ oop เส้ดดดด</a>
                <p class="info_text text-4 chapter_content">152</p>
                <p class="info_text text-4 chapter_content">12/5/2023</p>
                <p class="info_text text-3 text-2 chapter_content">#2</p>
                <a href="payment.html" class="text text-3 chapter_content">ขี้เกียจแล้ววววว</a>
                <p class="info_text text-4 chapter_content">100</p>
                <p class="info_text text-4 chapter_content">14/5/2023</p>
            </div>
        </div>
    </div>

    <!-- show chapter -->
    <div class="flexbox-3" style="display: flex; justify-content: center;">
        <div class="item-3" >
            <a class="submit_button" onclick="showChapter('Shin_chan')">see Chapter</a>
        </div>
        <div id="chaptersContainer"></div>
    </div>

    <!-- add comment -->
    <div class="flexbox-3">
        <div class="item-3">
            <div class="search_item">
                <form id="commentForm">
                    <h1 class="info_title">Chapter no :</h1>
                    <select id="chapter_id" name="chapter_id" class="input_box" style="width: 25%;">
                        <!-- <option value="Shin_chan" class="input_box">book</option> -->
                        <option value="Shin_chan-1" class="input_box">Chapter 1</option>
                        <option value="Shin_chan-2" class="input_box">Chapter 2</option>
                    </select><br><br>
                    <!-- <input type="text" id="chapter_id" name="chapter_id" placeholder="chapter_id" required><br><br> -->

                    <h1 class="info_title">Your Username : </h1>
                    <input type="text" class="input_box" id="username" style="width: 40%;" name="username" placeholder="username" required><br><br>

                    <h1 class="info_title">Your Comment : </h1>
                    <textarea id="context" class="input_box" name="context" style="width: 40%;" rows="4" cols="50" placeholder="context"
                        required></textarea><br><br>

                    <button type="submit" class="submit_button">Submit</button>
                </form>
            </div>
        </div>
    </div>

    <!-- show comment -->
    <div class="flexbox-3" style="display: flex; justify-content: center;">
        <div class="item-3" >
            <a class="submit_button" onclick="showComment('Shin_chan')">see comment</a>
        </div>
    </div>
    <div id="commentsContainer"></div>
    <!-- <div id="commentDiv"></div> -->


    <!-- footer -->
    <footer class="footer">
        <div class="footer_item_container">
            <a class="footer_home_button" href="https://www.readawrite.com/">ReadAWrite</a>
        </div>
        <div class="footer_item_container">
            <a class="footer_menu_text" href="payment.html">Payment</a>
        </div>
        <div class="footer_item_container">
            <a class="footer_menu_text" href="MyPage.html">My Page</a>
        </div>
        <div class="footer_item_container">
            <a class="footer_menu_text" href="search_page.html">search</a>
        </div>
        <div class="footer_item_container">
            <a class="footer_menu_text" href="payment.html">Payment</a>
        </div>
        <div class="footer_item_container">
            <p class="footer_menu_text">© 2024 - 2024 Teletubbies Book Center | All Rights Reserved.</p>
        </div>
    </footer>
    <br>

    <script>
        // Retrieve book information from sessionStorage
        const bookInfoString = sessionStorage.getItem('bookInfo');
        console.log("bookInfoString",bookInfoString)
        if (bookInfoString) {
            try {
                const bookInfo = JSON.parse(bookInfoString);
                console.log("bookInfo", bookInfo);

                if (bookInfo) {
                    const { genre, name, pseudonym, prologue, writer_name, date_time } = bookInfo;

                    // Display book information in the HTML page
                    document.getElementById('genre').textContent = genre || '';
                    document.getElementById('bookName').textContent = name || '';
                    document.getElementById('prologueInfo').textContent = prologue || '';
                    document.getElementById('prologueDisplay').textContent = prologue || '';
                    document.getElementById('writer_username').textContent = writer_name || '';
                    document.getElementById('date_time').textContent = date_time || '';
                    document.getElementById('pseudonymInfo').textContent = pseudonym || '';
                    document.getElementById('pseudonymDisplay').textContent = pseudonym || '';
                } else {
                    console.error('bookInfo object is null or undefined.');
                }
            } catch (error) {
                console.error('Error parsing bookInfo JSON:', error);
            }
        } else {
            console.error('bookInfo is null or undefined.');
        }

        // Retrieve the comment data from sessionStorage
        const commentDataUse = JSON.parse(sessionStorage.getItem('commentData'));
        const commentsContainer = document.getElementById('commentsContainer');
        commentsContainer.innerHTML = ''; // Clear existing comments
        console.log(commentsContainer)
        // Check if commentDataUse is not null and is an array
        if (commentDataUse && Array.isArray(commentDataUse)) {
            // Iterate over each comment data and create HTML elements
            commentDataUse.forEach(commentData => {
                console.log("commentData",commentData)
                commentsContainer.innerHTML += `
                    <div class="flexbox-3">
                        <div class="item-3">
                            <div class="comment-context-text">${commentData.context}</div>
                            <div class="comment-username-text">${commentData.user}</div>
                            <div class="comment-date-text">${commentData.date_time}</div>
                            <div class="comment-chapter-text">${commentData.chapter}</div>
                        </div>
                    </div>
                `;
            });
        } else {
            console.error('commentDataUse is null or not an array.');
        }

        const chapterDataUse = JSON.parse(sessionStorage.getItem('chapterData'));
        const chaptersContainer = document.getElementById('chaptersContainer');
        chaptersContainer.innerHTML = ''; // Clear existing chapter
        console.log(chaptersContainer)
        // Check if chapterDataUse is not null and is an array
        if (chapterDataUse && Array.isArray(chapterDataUse)) {
            // Iterate over each comment data and create HTML elements
            chapterDataUse.forEach(chapterData => {
                console.log("chapterData",chapterData)
                chaptersContainer.innerHTML += `
                    <div class="item-3" style="width: 100%;">
                        <div class="box" style="width: 12.5%;">${chapterData.chapter_number}</div>
                        <div class="box" style="width: 50%;">${chapterData.name}</div>
                        <div class="box" style="width: 12.5%;">${chapterData.viewer}</div>
                        <div class="box" style="width: 12.5%;">${chapterData.price}</div>
                        <div class="box" style="width: 25%;">${chapterData.date_time}</div>
                    </div>
                `;
            });
        } else {
            console.error('chapterDataUse is null or not an array.');
        }

    </script>
</body>

</html>